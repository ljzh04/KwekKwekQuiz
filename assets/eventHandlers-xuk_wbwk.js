import{n as K,q as y,o as In,p as R,r as Re,t as Le,u as Fe,v as ke,w as Me,x as De,y as oe,z as le,A as Be,B as He,C as Ge,D as Ye,E as Pe,F as Ue,G as je,H as On,I as he,J as D}from"./dom-BKcPZjMx.js";import{s as Ci,g as yi,i as _i,a as Si}from"./state-DFIgnp9Y.js";import{a as T,c as q,s as ae}from"./utils-DJpVKuP1.js";import{handleSaveQuiz as Ii,handleDeleteQuiz as Oi,handleSavedQuizSelectChange as wi,handleExportQuizzes as Ti,handleImportQuizzes as bi,handleClearAllQuizzes as Ni}from"./storageManager-CX_bLrDr.js";import{g as wn,a as Tn,h as Ri,r as Li,s as Fi}from"./quizPlayer-pvcmHlR0.js";import{s as ki}from"./uiController-Duq5DQLh.js";/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */function bn(e){return typeof e>"u"||e===null}function Mi(e){return typeof e=="object"&&e!==null}function Di(e){return Array.isArray(e)?e:bn(e)?[]:[e]}function Bi(e,n){var i,t,r,l;if(n)for(l=Object.keys(n),i=0,t=l.length;i<t;i+=1)r=l[i],e[r]=n[r];return e}function Hi(e,n){var i="",t;for(t=0;t<n;t+=1)i+=e;return i}function Gi(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}var Yi=bn,Pi=Mi,Ui=Di,ji=Hi,Ki=Gi,qi=Bi,E={isNothing:Yi,isObject:Pi,toArray:Ui,repeat:ji,isNegativeZero:Ki,extend:qi};function Nn(e,n){var i="",t=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(i+='in "'+e.mark.name+'" '),i+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!n&&e.mark.snippet&&(i+=`

`+e.mark.snippet),t+" "+i):t}function J(e,n){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=n,this.message=Nn(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}J.prototype=Object.create(Error.prototype);J.prototype.constructor=J;J.prototype.toString=function(n){return this.name+": "+Nn(this,n)};var I=J;function ge(e,n,i,t,r){var l="",o="",a=Math.floor(r/2)-1;return t-n>a&&(l=" ... ",n=t-a+l.length),i-t>a&&(o=" ...",i=t+a-o.length),{str:l+e.slice(n,i).replace(/\t/g,"→")+o,pos:t-n+l.length}}function me(e,n){return E.repeat(" ",n-e.length)+e}function $i(e,n){if(n=Object.create(n||null),!e.buffer)return null;n.maxLength||(n.maxLength=79),typeof n.indent!="number"&&(n.indent=1),typeof n.linesBefore!="number"&&(n.linesBefore=3),typeof n.linesAfter!="number"&&(n.linesAfter=2);for(var i=/\r?\n|\r|\0/g,t=[0],r=[],l,o=-1;l=i.exec(e.buffer);)r.push(l.index),t.push(l.index+l[0].length),e.position<=l.index&&o<0&&(o=t.length-2);o<0&&(o=t.length-1);var a="",u,s,p=Math.min(e.line+n.linesAfter,r.length).toString().length,c=n.maxLength-(n.indent+p+3);for(u=1;u<=n.linesBefore&&!(o-u<0);u++)s=ge(e.buffer,t[o-u],r[o-u],e.position-(t[o]-t[o-u]),c),a=E.repeat(" ",n.indent)+me((e.line-u+1).toString(),p)+" | "+s.str+`
`+a;for(s=ge(e.buffer,t[o],r[o],e.position,c),a+=E.repeat(" ",n.indent)+me((e.line+1).toString(),p)+" | "+s.str+`
`,a+=E.repeat("-",n.indent+p+3+s.pos)+`^
`,u=1;u<=n.linesAfter&&!(o+u>=r.length);u++)s=ge(e.buffer,t[o+u],r[o+u],e.position-(t[o]-t[o+u]),c),a+=E.repeat(" ",n.indent)+me((e.line+u+1).toString(),p)+" | "+s.str+`
`;return a.replace(/\n$/,"")}var zi=$i,Qi=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],Ji=["scalar","sequence","mapping"];function Vi(e){var n={};return e!==null&&Object.keys(e).forEach(function(i){e[i].forEach(function(t){n[String(t)]=i})}),n}function Wi(e,n){if(n=n||{},Object.keys(n).forEach(function(i){if(Qi.indexOf(i)===-1)throw new I('Unknown option "'+i+'" is met in definition of "'+e+'" YAML type.')}),this.options=n,this.tag=e,this.kind=n.kind||null,this.resolve=n.resolve||function(){return!0},this.construct=n.construct||function(i){return i},this.instanceOf=n.instanceOf||null,this.predicate=n.predicate||null,this.represent=n.represent||null,this.representName=n.representName||null,this.defaultStyle=n.defaultStyle||null,this.multi=n.multi||!1,this.styleAliases=Vi(n.styleAliases||null),Ji.indexOf(this.kind)===-1)throw new I('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var C=Wi;function Ke(e,n){var i=[];return e[n].forEach(function(t){var r=i.length;i.forEach(function(l,o){l.tag===t.tag&&l.kind===t.kind&&l.multi===t.multi&&(r=o)}),i[r]=t}),i}function Xi(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},n,i;function t(r){r.multi?(e.multi[r.kind].push(r),e.multi.fallback.push(r)):e[r.kind][r.tag]=e.fallback[r.tag]=r}for(n=0,i=arguments.length;n<i;n+=1)arguments[n].forEach(t);return e}function xe(e){return this.extend(e)}xe.prototype.extend=function(n){var i=[],t=[];if(n instanceof C)t.push(n);else if(Array.isArray(n))t=t.concat(n);else if(n&&(Array.isArray(n.implicit)||Array.isArray(n.explicit)))n.implicit&&(i=i.concat(n.implicit)),n.explicit&&(t=t.concat(n.explicit));else throw new I("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");i.forEach(function(l){if(!(l instanceof C))throw new I("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(l.loadKind&&l.loadKind!=="scalar")throw new I("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(l.multi)throw new I("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),t.forEach(function(l){if(!(l instanceof C))throw new I("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var r=Object.create(xe.prototype);return r.implicit=(this.implicit||[]).concat(i),r.explicit=(this.explicit||[]).concat(t),r.compiledImplicit=Ke(r,"implicit"),r.compiledExplicit=Ke(r,"explicit"),r.compiledTypeMap=Xi(r.compiledImplicit,r.compiledExplicit),r};var Rn=xe,Ln=new C("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return e!==null?e:""}}),Fn=new C("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return e!==null?e:[]}}),kn=new C("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return e!==null?e:{}}}),Mn=new Rn({explicit:[Ln,Fn,kn]});function Zi(e){if(e===null)return!0;var n=e.length;return n===1&&e==="~"||n===4&&(e==="null"||e==="Null"||e==="NULL")}function er(){return null}function nr(e){return e===null}var Dn=new C("tag:yaml.org,2002:null",{kind:"scalar",resolve:Zi,construct:er,predicate:nr,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function ir(e){if(e===null)return!1;var n=e.length;return n===4&&(e==="true"||e==="True"||e==="TRUE")||n===5&&(e==="false"||e==="False"||e==="FALSE")}function rr(e){return e==="true"||e==="True"||e==="TRUE"}function tr(e){return Object.prototype.toString.call(e)==="[object Boolean]"}var Bn=new C("tag:yaml.org,2002:bool",{kind:"scalar",resolve:ir,construct:rr,predicate:tr,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function or(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function lr(e){return 48<=e&&e<=55}function ar(e){return 48<=e&&e<=57}function ur(e){if(e===null)return!1;var n=e.length,i=0,t=!1,r;if(!n)return!1;if(r=e[i],(r==="-"||r==="+")&&(r=e[++i]),r==="0"){if(i+1===n)return!0;if(r=e[++i],r==="b"){for(i++;i<n;i++)if(r=e[i],r!=="_"){if(r!=="0"&&r!=="1")return!1;t=!0}return t&&r!=="_"}if(r==="x"){for(i++;i<n;i++)if(r=e[i],r!=="_"){if(!or(e.charCodeAt(i)))return!1;t=!0}return t&&r!=="_"}if(r==="o"){for(i++;i<n;i++)if(r=e[i],r!=="_"){if(!lr(e.charCodeAt(i)))return!1;t=!0}return t&&r!=="_"}}if(r==="_")return!1;for(;i<n;i++)if(r=e[i],r!=="_"){if(!ar(e.charCodeAt(i)))return!1;t=!0}return!(!t||r==="_")}function sr(e){var n=e,i=1,t;if(n.indexOf("_")!==-1&&(n=n.replace(/_/g,"")),t=n[0],(t==="-"||t==="+")&&(t==="-"&&(i=-1),n=n.slice(1),t=n[0]),n==="0")return 0;if(t==="0"){if(n[1]==="b")return i*parseInt(n.slice(2),2);if(n[1]==="x")return i*parseInt(n.slice(2),16);if(n[1]==="o")return i*parseInt(n.slice(2),8)}return i*parseInt(n,10)}function cr(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!E.isNegativeZero(e)}var Hn=new C("tag:yaml.org,2002:int",{kind:"scalar",resolve:ur,construct:sr,predicate:cr,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),fr=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function dr(e){return!(e===null||!fr.test(e)||e[e.length-1]==="_")}function pr(e){var n,i;return n=e.replace(/_/g,"").toLowerCase(),i=n[0]==="-"?-1:1,"+-".indexOf(n[0])>=0&&(n=n.slice(1)),n===".inf"?i===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:n===".nan"?NaN:i*parseFloat(n,10)}var hr=/^[-+]?[0-9]+e/;function gr(e,n){var i;if(isNaN(e))switch(n){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(n){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(n){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(E.isNegativeZero(e))return"-0.0";return i=e.toString(10),hr.test(i)?i.replace("e",".e"):i}function mr(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||E.isNegativeZero(e))}var Gn=new C("tag:yaml.org,2002:float",{kind:"scalar",resolve:dr,construct:pr,predicate:mr,represent:gr,defaultStyle:"lowercase"}),Yn=Mn.extend({implicit:[Dn,Bn,Hn,Gn]}),Pn=Yn,Un=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),jn=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function vr(e){return e===null?!1:Un.exec(e)!==null||jn.exec(e)!==null}function Ar(e){var n,i,t,r,l,o,a,u=0,s=null,p,c,f;if(n=Un.exec(e),n===null&&(n=jn.exec(e)),n===null)throw new Error("Date resolve error");if(i=+n[1],t=+n[2]-1,r=+n[3],!n[4])return new Date(Date.UTC(i,t,r));if(l=+n[4],o=+n[5],a=+n[6],n[7]){for(u=n[7].slice(0,3);u.length<3;)u+="0";u=+u}return n[9]&&(p=+n[10],c=+(n[11]||0),s=(p*60+c)*6e4,n[9]==="-"&&(s=-s)),f=new Date(Date.UTC(i,t,r,l,o,a,u)),s&&f.setTime(f.getTime()-s),f}function xr(e){return e.toISOString()}var Kn=new C("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:vr,construct:Ar,instanceOf:Date,represent:xr});function Er(e){return e==="<<"||e===null}var qn=new C("tag:yaml.org,2002:merge",{kind:"scalar",resolve:Er}),Se=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function Cr(e){if(e===null)return!1;var n,i,t=0,r=e.length,l=Se;for(i=0;i<r;i++)if(n=l.indexOf(e.charAt(i)),!(n>64)){if(n<0)return!1;t+=6}return t%8===0}function yr(e){var n,i,t=e.replace(/[\r\n=]/g,""),r=t.length,l=Se,o=0,a=[];for(n=0;n<r;n++)n%4===0&&n&&(a.push(o>>16&255),a.push(o>>8&255),a.push(o&255)),o=o<<6|l.indexOf(t.charAt(n));return i=r%4*6,i===0?(a.push(o>>16&255),a.push(o>>8&255),a.push(o&255)):i===18?(a.push(o>>10&255),a.push(o>>2&255)):i===12&&a.push(o>>4&255),new Uint8Array(a)}function _r(e){var n="",i=0,t,r,l=e.length,o=Se;for(t=0;t<l;t++)t%3===0&&t&&(n+=o[i>>18&63],n+=o[i>>12&63],n+=o[i>>6&63],n+=o[i&63]),i=(i<<8)+e[t];return r=l%3,r===0?(n+=o[i>>18&63],n+=o[i>>12&63],n+=o[i>>6&63],n+=o[i&63]):r===2?(n+=o[i>>10&63],n+=o[i>>4&63],n+=o[i<<2&63],n+=o[64]):r===1&&(n+=o[i>>2&63],n+=o[i<<4&63],n+=o[64],n+=o[64]),n}function Sr(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}var $n=new C("tag:yaml.org,2002:binary",{kind:"scalar",resolve:Cr,construct:yr,predicate:Sr,represent:_r}),Ir=Object.prototype.hasOwnProperty,Or=Object.prototype.toString;function wr(e){if(e===null)return!0;var n=[],i,t,r,l,o,a=e;for(i=0,t=a.length;i<t;i+=1){if(r=a[i],o=!1,Or.call(r)!=="[object Object]")return!1;for(l in r)if(Ir.call(r,l))if(!o)o=!0;else return!1;if(!o)return!1;if(n.indexOf(l)===-1)n.push(l);else return!1}return!0}function Tr(e){return e!==null?e:[]}var zn=new C("tag:yaml.org,2002:omap",{kind:"sequence",resolve:wr,construct:Tr}),br=Object.prototype.toString;function Nr(e){if(e===null)return!0;var n,i,t,r,l,o=e;for(l=new Array(o.length),n=0,i=o.length;n<i;n+=1){if(t=o[n],br.call(t)!=="[object Object]"||(r=Object.keys(t),r.length!==1))return!1;l[n]=[r[0],t[r[0]]]}return!0}function Rr(e){if(e===null)return[];var n,i,t,r,l,o=e;for(l=new Array(o.length),n=0,i=o.length;n<i;n+=1)t=o[n],r=Object.keys(t),l[n]=[r[0],t[r[0]]];return l}var Qn=new C("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:Nr,construct:Rr}),Lr=Object.prototype.hasOwnProperty;function Fr(e){if(e===null)return!0;var n,i=e;for(n in i)if(Lr.call(i,n)&&i[n]!==null)return!1;return!0}function kr(e){return e!==null?e:{}}var Jn=new C("tag:yaml.org,2002:set",{kind:"mapping",resolve:Fr,construct:kr}),Ie=Pn.extend({implicit:[Kn,qn],explicit:[$n,zn,Qn,Jn]}),M=Object.prototype.hasOwnProperty,ue=1,Vn=2,Wn=3,se=4,ve=1,Mr=2,qe=3,Dr=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,Br=/[\x85\u2028\u2029]/,Hr=/[,\[\]\{\}]/,Xn=/^(?:!|!!|![a-z\-]+!)$/i,Zn=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function $e(e){return Object.prototype.toString.call(e)}function b(e){return e===10||e===13}function B(e){return e===9||e===32}function O(e){return e===9||e===32||e===10||e===13}function U(e){return e===44||e===91||e===93||e===123||e===125}function Gr(e){var n;return 48<=e&&e<=57?e-48:(n=e|32,97<=n&&n<=102?n-97+10:-1)}function Yr(e){return e===120?2:e===117?4:e===85?8:0}function Pr(e){return 48<=e&&e<=57?e-48:-1}function ze(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?" ":e===76?"\u2028":e===80?"\u2029":""}function Ur(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}var ei=new Array(256),ni=new Array(256);for(var G=0;G<256;G++)ei[G]=ze(G)?1:0,ni[G]=ze(G);function jr(e,n){this.input=e,this.filename=n.filename||null,this.schema=n.schema||Ie,this.onWarning=n.onWarning||null,this.legacy=n.legacy||!1,this.json=n.json||!1,this.listener=n.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function ii(e,n){var i={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return i.snippet=zi(i),new I(n,i)}function h(e,n){throw ii(e,n)}function ce(e,n){e.onWarning&&e.onWarning.call(null,ii(e,n))}var Qe={YAML:function(n,i,t){var r,l,o;n.version!==null&&h(n,"duplication of %YAML directive"),t.length!==1&&h(n,"YAML directive accepts exactly one argument"),r=/^([0-9]+)\.([0-9]+)$/.exec(t[0]),r===null&&h(n,"ill-formed argument of the YAML directive"),l=parseInt(r[1],10),o=parseInt(r[2],10),l!==1&&h(n,"unacceptable YAML version of the document"),n.version=t[0],n.checkLineBreaks=o<2,o!==1&&o!==2&&ce(n,"unsupported YAML version of the document")},TAG:function(n,i,t){var r,l;t.length!==2&&h(n,"TAG directive accepts exactly two arguments"),r=t[0],l=t[1],Xn.test(r)||h(n,"ill-formed tag handle (first argument) of the TAG directive"),M.call(n.tagMap,r)&&h(n,'there is a previously declared suffix for "'+r+'" tag handle'),Zn.test(l)||h(n,"ill-formed tag prefix (second argument) of the TAG directive");try{l=decodeURIComponent(l)}catch{h(n,"tag prefix is malformed: "+l)}n.tagMap[r]=l}};function F(e,n,i,t){var r,l,o,a;if(n<i){if(a=e.input.slice(n,i),t)for(r=0,l=a.length;r<l;r+=1)o=a.charCodeAt(r),o===9||32<=o&&o<=1114111||h(e,"expected valid JSON character");else Dr.test(a)&&h(e,"the stream contains non-printable characters");e.result+=a}}function Je(e,n,i,t){var r,l,o,a;for(E.isObject(i)||h(e,"cannot merge mappings; the provided source object is unacceptable"),r=Object.keys(i),o=0,a=r.length;o<a;o+=1)l=r[o],M.call(n,l)||(n[l]=i[l],t[l]=!0)}function j(e,n,i,t,r,l,o,a,u){var s,p;if(Array.isArray(r))for(r=Array.prototype.slice.call(r),s=0,p=r.length;s<p;s+=1)Array.isArray(r[s])&&h(e,"nested arrays are not supported inside keys"),typeof r=="object"&&$e(r[s])==="[object Object]"&&(r[s]="[object Object]");if(typeof r=="object"&&$e(r)==="[object Object]"&&(r="[object Object]"),r=String(r),n===null&&(n={}),t==="tag:yaml.org,2002:merge")if(Array.isArray(l))for(s=0,p=l.length;s<p;s+=1)Je(e,n,l[s],i);else Je(e,n,l,i);else!e.json&&!M.call(i,r)&&M.call(n,r)&&(e.line=o||e.line,e.lineStart=a||e.lineStart,e.position=u||e.position,h(e,"duplicated mapping key")),r==="__proto__"?Object.defineProperty(n,r,{configurable:!0,enumerable:!0,writable:!0,value:l}):n[r]=l,delete i[r];return n}function Oe(e){var n;n=e.input.charCodeAt(e.position),n===10?e.position++:n===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):h(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function x(e,n,i){for(var t=0,r=e.input.charCodeAt(e.position);r!==0;){for(;B(r);)r===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),r=e.input.charCodeAt(++e.position);if(n&&r===35)do r=e.input.charCodeAt(++e.position);while(r!==10&&r!==13&&r!==0);if(b(r))for(Oe(e),r=e.input.charCodeAt(e.position),t++,e.lineIndent=0;r===32;)e.lineIndent++,r=e.input.charCodeAt(++e.position);else break}return i!==-1&&t!==0&&e.lineIndent<i&&ce(e,"deficient indentation"),t}function pe(e){var n=e.position,i;return i=e.input.charCodeAt(n),!!((i===45||i===46)&&i===e.input.charCodeAt(n+1)&&i===e.input.charCodeAt(n+2)&&(n+=3,i=e.input.charCodeAt(n),i===0||O(i)))}function we(e,n){n===1?e.result+=" ":n>1&&(e.result+=E.repeat(`
`,n-1))}function Kr(e,n,i){var t,r,l,o,a,u,s,p,c=e.kind,f=e.result,d;if(d=e.input.charCodeAt(e.position),O(d)||U(d)||d===35||d===38||d===42||d===33||d===124||d===62||d===39||d===34||d===37||d===64||d===96||(d===63||d===45)&&(r=e.input.charCodeAt(e.position+1),O(r)||i&&U(r)))return!1;for(e.kind="scalar",e.result="",l=o=e.position,a=!1;d!==0;){if(d===58){if(r=e.input.charCodeAt(e.position+1),O(r)||i&&U(r))break}else if(d===35){if(t=e.input.charCodeAt(e.position-1),O(t))break}else{if(e.position===e.lineStart&&pe(e)||i&&U(d))break;if(b(d))if(u=e.line,s=e.lineStart,p=e.lineIndent,x(e,!1,-1),e.lineIndent>=n){a=!0,d=e.input.charCodeAt(e.position);continue}else{e.position=o,e.line=u,e.lineStart=s,e.lineIndent=p;break}}a&&(F(e,l,o,!1),we(e,e.line-u),l=o=e.position,a=!1),B(d)||(o=e.position+1),d=e.input.charCodeAt(++e.position)}return F(e,l,o,!1),e.result?!0:(e.kind=c,e.result=f,!1)}function qr(e,n){var i,t,r;if(i=e.input.charCodeAt(e.position),i!==39)return!1;for(e.kind="scalar",e.result="",e.position++,t=r=e.position;(i=e.input.charCodeAt(e.position))!==0;)if(i===39)if(F(e,t,e.position,!0),i=e.input.charCodeAt(++e.position),i===39)t=e.position,e.position++,r=e.position;else return!0;else b(i)?(F(e,t,r,!0),we(e,x(e,!1,n)),t=r=e.position):e.position===e.lineStart&&pe(e)?h(e,"unexpected end of the document within a single quoted scalar"):(e.position++,r=e.position);h(e,"unexpected end of the stream within a single quoted scalar")}function $r(e,n){var i,t,r,l,o,a;if(a=e.input.charCodeAt(e.position),a!==34)return!1;for(e.kind="scalar",e.result="",e.position++,i=t=e.position;(a=e.input.charCodeAt(e.position))!==0;){if(a===34)return F(e,i,e.position,!0),e.position++,!0;if(a===92){if(F(e,i,e.position,!0),a=e.input.charCodeAt(++e.position),b(a))x(e,!1,n);else if(a<256&&ei[a])e.result+=ni[a],e.position++;else if((o=Yr(a))>0){for(r=o,l=0;r>0;r--)a=e.input.charCodeAt(++e.position),(o=Gr(a))>=0?l=(l<<4)+o:h(e,"expected hexadecimal character");e.result+=Ur(l),e.position++}else h(e,"unknown escape sequence");i=t=e.position}else b(a)?(F(e,i,t,!0),we(e,x(e,!1,n)),i=t=e.position):e.position===e.lineStart&&pe(e)?h(e,"unexpected end of the document within a double quoted scalar"):(e.position++,t=e.position)}h(e,"unexpected end of the stream within a double quoted scalar")}function zr(e,n){var i=!0,t,r,l,o=e.tag,a,u=e.anchor,s,p,c,f,d,g=Object.create(null),m,A,w,v;if(v=e.input.charCodeAt(e.position),v===91)p=93,d=!1,a=[];else if(v===123)p=125,d=!0,a={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=a),v=e.input.charCodeAt(++e.position);v!==0;){if(x(e,!0,n),v=e.input.charCodeAt(e.position),v===p)return e.position++,e.tag=o,e.anchor=u,e.kind=d?"mapping":"sequence",e.result=a,!0;i?v===44&&h(e,"expected the node content, but found ','"):h(e,"missed comma between flow collection entries"),A=m=w=null,c=f=!1,v===63&&(s=e.input.charCodeAt(e.position+1),O(s)&&(c=f=!0,e.position++,x(e,!0,n))),t=e.line,r=e.lineStart,l=e.position,$(e,n,ue,!1,!0),A=e.tag,m=e.result,x(e,!0,n),v=e.input.charCodeAt(e.position),(f||e.line===t)&&v===58&&(c=!0,v=e.input.charCodeAt(++e.position),x(e,!0,n),$(e,n,ue,!1,!0),w=e.result),d?j(e,a,g,A,m,w,t,r,l):c?a.push(j(e,null,g,A,m,w,t,r,l)):a.push(m),x(e,!0,n),v=e.input.charCodeAt(e.position),v===44?(i=!0,v=e.input.charCodeAt(++e.position)):i=!1}h(e,"unexpected end of the stream within a flow collection")}function Qr(e,n){var i,t,r=ve,l=!1,o=!1,a=n,u=0,s=!1,p,c;if(c=e.input.charCodeAt(e.position),c===124)t=!1;else if(c===62)t=!0;else return!1;for(e.kind="scalar",e.result="";c!==0;)if(c=e.input.charCodeAt(++e.position),c===43||c===45)ve===r?r=c===43?qe:Mr:h(e,"repeat of a chomping mode identifier");else if((p=Pr(c))>=0)p===0?h(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):o?h(e,"repeat of an indentation width identifier"):(a=n+p-1,o=!0);else break;if(B(c)){do c=e.input.charCodeAt(++e.position);while(B(c));if(c===35)do c=e.input.charCodeAt(++e.position);while(!b(c)&&c!==0)}for(;c!==0;){for(Oe(e),e.lineIndent=0,c=e.input.charCodeAt(e.position);(!o||e.lineIndent<a)&&c===32;)e.lineIndent++,c=e.input.charCodeAt(++e.position);if(!o&&e.lineIndent>a&&(a=e.lineIndent),b(c)){u++;continue}if(e.lineIndent<a){r===qe?e.result+=E.repeat(`
`,l?1+u:u):r===ve&&l&&(e.result+=`
`);break}for(t?B(c)?(s=!0,e.result+=E.repeat(`
`,l?1+u:u)):s?(s=!1,e.result+=E.repeat(`
`,u+1)):u===0?l&&(e.result+=" "):e.result+=E.repeat(`
`,u):e.result+=E.repeat(`
`,l?1+u:u),l=!0,o=!0,u=0,i=e.position;!b(c)&&c!==0;)c=e.input.charCodeAt(++e.position);F(e,i,e.position,!1)}return!0}function Ve(e,n){var i,t=e.tag,r=e.anchor,l=[],o,a=!1,u;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=l),u=e.input.charCodeAt(e.position);u!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,h(e,"tab characters must not be used in indentation")),!(u!==45||(o=e.input.charCodeAt(e.position+1),!O(o))));){if(a=!0,e.position++,x(e,!0,-1)&&e.lineIndent<=n){l.push(null),u=e.input.charCodeAt(e.position);continue}if(i=e.line,$(e,n,Wn,!1,!0),l.push(e.result),x(e,!0,-1),u=e.input.charCodeAt(e.position),(e.line===i||e.lineIndent>n)&&u!==0)h(e,"bad indentation of a sequence entry");else if(e.lineIndent<n)break}return a?(e.tag=t,e.anchor=r,e.kind="sequence",e.result=l,!0):!1}function Jr(e,n,i){var t,r,l,o,a,u,s=e.tag,p=e.anchor,c={},f=Object.create(null),d=null,g=null,m=null,A=!1,w=!1,v;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=c),v=e.input.charCodeAt(e.position);v!==0;){if(!A&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,h(e,"tab characters must not be used in indentation")),t=e.input.charCodeAt(e.position+1),l=e.line,(v===63||v===58)&&O(t))v===63?(A&&(j(e,c,f,d,g,null,o,a,u),d=g=m=null),w=!0,A=!0,r=!0):A?(A=!1,r=!0):h(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,v=t;else{if(o=e.line,a=e.lineStart,u=e.position,!$(e,i,Vn,!1,!0))break;if(e.line===l){for(v=e.input.charCodeAt(e.position);B(v);)v=e.input.charCodeAt(++e.position);if(v===58)v=e.input.charCodeAt(++e.position),O(v)||h(e,"a whitespace character is expected after the key-value separator within a block mapping"),A&&(j(e,c,f,d,g,null,o,a,u),d=g=m=null),w=!0,A=!1,r=!1,d=e.tag,g=e.result;else if(w)h(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=s,e.anchor=p,!0}else if(w)h(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=s,e.anchor=p,!0}if((e.line===l||e.lineIndent>n)&&(A&&(o=e.line,a=e.lineStart,u=e.position),$(e,n,se,!0,r)&&(A?g=e.result:m=e.result),A||(j(e,c,f,d,g,m,o,a,u),d=g=m=null),x(e,!0,-1),v=e.input.charCodeAt(e.position)),(e.line===l||e.lineIndent>n)&&v!==0)h(e,"bad indentation of a mapping entry");else if(e.lineIndent<n)break}return A&&j(e,c,f,d,g,null,o,a,u),w&&(e.tag=s,e.anchor=p,e.kind="mapping",e.result=c),w}function Vr(e){var n,i=!1,t=!1,r,l,o;if(o=e.input.charCodeAt(e.position),o!==33)return!1;if(e.tag!==null&&h(e,"duplication of a tag property"),o=e.input.charCodeAt(++e.position),o===60?(i=!0,o=e.input.charCodeAt(++e.position)):o===33?(t=!0,r="!!",o=e.input.charCodeAt(++e.position)):r="!",n=e.position,i){do o=e.input.charCodeAt(++e.position);while(o!==0&&o!==62);e.position<e.length?(l=e.input.slice(n,e.position),o=e.input.charCodeAt(++e.position)):h(e,"unexpected end of the stream within a verbatim tag")}else{for(;o!==0&&!O(o);)o===33&&(t?h(e,"tag suffix cannot contain exclamation marks"):(r=e.input.slice(n-1,e.position+1),Xn.test(r)||h(e,"named tag handle cannot contain such characters"),t=!0,n=e.position+1)),o=e.input.charCodeAt(++e.position);l=e.input.slice(n,e.position),Hr.test(l)&&h(e,"tag suffix cannot contain flow indicator characters")}l&&!Zn.test(l)&&h(e,"tag name cannot contain such characters: "+l);try{l=decodeURIComponent(l)}catch{h(e,"tag name is malformed: "+l)}return i?e.tag=l:M.call(e.tagMap,r)?e.tag=e.tagMap[r]+l:r==="!"?e.tag="!"+l:r==="!!"?e.tag="tag:yaml.org,2002:"+l:h(e,'undeclared tag handle "'+r+'"'),!0}function Wr(e){var n,i;if(i=e.input.charCodeAt(e.position),i!==38)return!1;for(e.anchor!==null&&h(e,"duplication of an anchor property"),i=e.input.charCodeAt(++e.position),n=e.position;i!==0&&!O(i)&&!U(i);)i=e.input.charCodeAt(++e.position);return e.position===n&&h(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(n,e.position),!0}function Xr(e){var n,i,t;if(t=e.input.charCodeAt(e.position),t!==42)return!1;for(t=e.input.charCodeAt(++e.position),n=e.position;t!==0&&!O(t)&&!U(t);)t=e.input.charCodeAt(++e.position);return e.position===n&&h(e,"name of an alias node must contain at least one character"),i=e.input.slice(n,e.position),M.call(e.anchorMap,i)||h(e,'unidentified alias "'+i+'"'),e.result=e.anchorMap[i],x(e,!0,-1),!0}function $(e,n,i,t,r){var l,o,a,u=1,s=!1,p=!1,c,f,d,g,m,A;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,l=o=a=se===i||Wn===i,t&&x(e,!0,-1)&&(s=!0,e.lineIndent>n?u=1:e.lineIndent===n?u=0:e.lineIndent<n&&(u=-1)),u===1)for(;Vr(e)||Wr(e);)x(e,!0,-1)?(s=!0,a=l,e.lineIndent>n?u=1:e.lineIndent===n?u=0:e.lineIndent<n&&(u=-1)):a=!1;if(a&&(a=s||r),(u===1||se===i)&&(ue===i||Vn===i?m=n:m=n+1,A=e.position-e.lineStart,u===1?a&&(Ve(e,A)||Jr(e,A,m))||zr(e,m)?p=!0:(o&&Qr(e,m)||qr(e,m)||$r(e,m)?p=!0:Xr(e)?(p=!0,(e.tag!==null||e.anchor!==null)&&h(e,"alias node should not have any properties")):Kr(e,m,ue===i)&&(p=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):u===0&&(p=a&&Ve(e,A))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&h(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),c=0,f=e.implicitTypes.length;c<f;c+=1)if(g=e.implicitTypes[c],g.resolve(e.result)){e.result=g.construct(e.result),e.tag=g.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(M.call(e.typeMap[e.kind||"fallback"],e.tag))g=e.typeMap[e.kind||"fallback"][e.tag];else for(g=null,d=e.typeMap.multi[e.kind||"fallback"],c=0,f=d.length;c<f;c+=1)if(e.tag.slice(0,d[c].tag.length)===d[c].tag){g=d[c];break}g||h(e,"unknown tag !<"+e.tag+">"),e.result!==null&&g.kind!==e.kind&&h(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+g.kind+'", not "'+e.kind+'"'),g.resolve(e.result,e.tag)?(e.result=g.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):h(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||p}function Zr(e){var n=e.position,i,t,r,l=!1,o;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(o=e.input.charCodeAt(e.position))!==0&&(x(e,!0,-1),o=e.input.charCodeAt(e.position),!(e.lineIndent>0||o!==37));){for(l=!0,o=e.input.charCodeAt(++e.position),i=e.position;o!==0&&!O(o);)o=e.input.charCodeAt(++e.position);for(t=e.input.slice(i,e.position),r=[],t.length<1&&h(e,"directive name must not be less than one character in length");o!==0;){for(;B(o);)o=e.input.charCodeAt(++e.position);if(o===35){do o=e.input.charCodeAt(++e.position);while(o!==0&&!b(o));break}if(b(o))break;for(i=e.position;o!==0&&!O(o);)o=e.input.charCodeAt(++e.position);r.push(e.input.slice(i,e.position))}o!==0&&Oe(e),M.call(Qe,t)?Qe[t](e,t,r):ce(e,'unknown document directive "'+t+'"')}if(x(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,x(e,!0,-1)):l&&h(e,"directives end mark is expected"),$(e,e.lineIndent-1,se,!1,!0),x(e,!0,-1),e.checkLineBreaks&&Br.test(e.input.slice(n,e.position))&&ce(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&pe(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,x(e,!0,-1));return}if(e.position<e.length-1)h(e,"end of the stream or a document separator is expected");else return}function ri(e,n){e=String(e),n=n||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var i=new jr(e,n),t=e.indexOf("\0");for(t!==-1&&(i.position=t,h(i,"null byte is not allowed in input")),i.input+="\0";i.input.charCodeAt(i.position)===32;)i.lineIndent+=1,i.position+=1;for(;i.position<i.length-1;)Zr(i);return i.documents}function et(e,n,i){n!==null&&typeof n=="object"&&typeof i>"u"&&(i=n,n=null);var t=ri(e,i);if(typeof n!="function")return t;for(var r=0,l=t.length;r<l;r+=1)n(t[r])}function nt(e,n){var i=ri(e,n);if(i.length!==0){if(i.length===1)return i[0];throw new I("expected a single document in the stream, but found more")}}var it=et,rt=nt,ti={loadAll:it,load:rt},oi=Object.prototype.toString,li=Object.prototype.hasOwnProperty,Te=65279,tt=9,V=10,ot=13,lt=32,at=33,ut=34,Ee=35,st=37,ct=38,ft=39,dt=42,ai=44,pt=45,fe=58,ht=61,gt=62,mt=63,vt=64,ui=91,si=93,At=96,ci=123,xt=124,fi=125,S={};S[0]="\\0";S[7]="\\a";S[8]="\\b";S[9]="\\t";S[10]="\\n";S[11]="\\v";S[12]="\\f";S[13]="\\r";S[27]="\\e";S[34]='\\"';S[92]="\\\\";S[133]="\\N";S[160]="\\_";S[8232]="\\L";S[8233]="\\P";var Et=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],Ct=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function yt(e,n){var i,t,r,l,o,a,u;if(n===null)return{};for(i={},t=Object.keys(n),r=0,l=t.length;r<l;r+=1)o=t[r],a=String(n[o]),o.slice(0,2)==="!!"&&(o="tag:yaml.org,2002:"+o.slice(2)),u=e.compiledTypeMap.fallback[o],u&&li.call(u.styleAliases,a)&&(a=u.styleAliases[a]),i[o]=a;return i}function _t(e){var n,i,t;if(n=e.toString(16).toUpperCase(),e<=255)i="x",t=2;else if(e<=65535)i="u",t=4;else if(e<=4294967295)i="U",t=8;else throw new I("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+i+E.repeat("0",t-n.length)+n}var St=1,W=2;function It(e){this.schema=e.schema||Ie,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=E.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=yt(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?W:St,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function We(e,n){for(var i=E.repeat(" ",n),t=0,r=-1,l="",o,a=e.length;t<a;)r=e.indexOf(`
`,t),r===-1?(o=e.slice(t),t=a):(o=e.slice(t,r+1),t=r+1),o.length&&o!==`
`&&(l+=i),l+=o;return l}function Ce(e,n){return`
`+E.repeat(" ",e.indent*n)}function Ot(e,n){var i,t,r;for(i=0,t=e.implicitTypes.length;i<t;i+=1)if(r=e.implicitTypes[i],r.resolve(n))return!0;return!1}function de(e){return e===lt||e===tt}function X(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==Te||65536<=e&&e<=1114111}function Xe(e){return X(e)&&e!==Te&&e!==ot&&e!==V}function Ze(e,n,i){var t=Xe(e),r=t&&!de(e);return(i?t:t&&e!==ai&&e!==ui&&e!==si&&e!==ci&&e!==fi)&&e!==Ee&&!(n===fe&&!r)||Xe(n)&&!de(n)&&e===Ee||n===fe&&r}function wt(e){return X(e)&&e!==Te&&!de(e)&&e!==pt&&e!==mt&&e!==fe&&e!==ai&&e!==ui&&e!==si&&e!==ci&&e!==fi&&e!==Ee&&e!==ct&&e!==dt&&e!==at&&e!==xt&&e!==ht&&e!==gt&&e!==ft&&e!==ut&&e!==st&&e!==vt&&e!==At}function Tt(e){return!de(e)&&e!==fe}function z(e,n){var i=e.charCodeAt(n),t;return i>=55296&&i<=56319&&n+1<e.length&&(t=e.charCodeAt(n+1),t>=56320&&t<=57343)?(i-55296)*1024+t-56320+65536:i}function di(e){var n=/^\n* /;return n.test(e)}var pi=1,ye=2,hi=3,gi=4,P=5;function bt(e,n,i,t,r,l,o,a){var u,s=0,p=null,c=!1,f=!1,d=t!==-1,g=-1,m=wt(z(e,0))&&Tt(z(e,e.length-1));if(n||o)for(u=0;u<e.length;s>=65536?u+=2:u++){if(s=z(e,u),!X(s))return P;m=m&&Ze(s,p,a),p=s}else{for(u=0;u<e.length;s>=65536?u+=2:u++){if(s=z(e,u),s===V)c=!0,d&&(f=f||u-g-1>t&&e[g+1]!==" ",g=u);else if(!X(s))return P;m=m&&Ze(s,p,a),p=s}f=f||d&&u-g-1>t&&e[g+1]!==" "}return!c&&!f?m&&!o&&!r(e)?pi:l===W?P:ye:i>9&&di(e)?P:o?l===W?P:ye:f?gi:hi}function Nt(e,n,i,t,r){e.dump=function(){if(n.length===0)return e.quotingType===W?'""':"''";if(!e.noCompatMode&&(Et.indexOf(n)!==-1||Ct.test(n)))return e.quotingType===W?'"'+n+'"':"'"+n+"'";var l=e.indent*Math.max(1,i),o=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-l),a=t||e.flowLevel>-1&&i>=e.flowLevel;function u(s){return Ot(e,s)}switch(bt(n,a,e.indent,o,u,e.quotingType,e.forceQuotes&&!t,r)){case pi:return n;case ye:return"'"+n.replace(/'/g,"''")+"'";case hi:return"|"+en(n,e.indent)+nn(We(n,l));case gi:return">"+en(n,e.indent)+nn(We(Rt(n,o),l));case P:return'"'+Lt(n)+'"';default:throw new I("impossible error: invalid scalar style")}}()}function en(e,n){var i=di(e)?String(n):"",t=e[e.length-1]===`
`,r=t&&(e[e.length-2]===`
`||e===`
`),l=r?"+":t?"":"-";return i+l+`
`}function nn(e){return e[e.length-1]===`
`?e.slice(0,-1):e}function Rt(e,n){for(var i=/(\n+)([^\n]*)/g,t=function(){var s=e.indexOf(`
`);return s=s!==-1?s:e.length,i.lastIndex=s,rn(e.slice(0,s),n)}(),r=e[0]===`
`||e[0]===" ",l,o;o=i.exec(e);){var a=o[1],u=o[2];l=u[0]===" ",t+=a+(!r&&!l&&u!==""?`
`:"")+rn(u,n),r=l}return t}function rn(e,n){if(e===""||e[0]===" ")return e;for(var i=/ [^ ]/g,t,r=0,l,o=0,a=0,u="";t=i.exec(e);)a=t.index,a-r>n&&(l=o>r?o:a,u+=`
`+e.slice(r,l),r=l+1),o=a;return u+=`
`,e.length-r>n&&o>r?u+=e.slice(r,o)+`
`+e.slice(o+1):u+=e.slice(r),u.slice(1)}function Lt(e){for(var n="",i=0,t,r=0;r<e.length;i>=65536?r+=2:r++)i=z(e,r),t=S[i],!t&&X(i)?(n+=e[r],i>=65536&&(n+=e[r+1])):n+=t||_t(i);return n}function Ft(e,n,i){var t="",r=e.tag,l,o,a;for(l=0,o=i.length;l<o;l+=1)a=i[l],e.replacer&&(a=e.replacer.call(i,String(l),a)),(N(e,n,a,!1,!1)||typeof a>"u"&&N(e,n,null,!1,!1))&&(t!==""&&(t+=","+(e.condenseFlow?"":" ")),t+=e.dump);e.tag=r,e.dump="["+t+"]"}function tn(e,n,i,t){var r="",l=e.tag,o,a,u;for(o=0,a=i.length;o<a;o+=1)u=i[o],e.replacer&&(u=e.replacer.call(i,String(o),u)),(N(e,n+1,u,!0,!0,!1,!0)||typeof u>"u"&&N(e,n+1,null,!0,!0,!1,!0))&&((!t||r!=="")&&(r+=Ce(e,n)),e.dump&&V===e.dump.charCodeAt(0)?r+="-":r+="- ",r+=e.dump);e.tag=l,e.dump=r||"[]"}function kt(e,n,i){var t="",r=e.tag,l=Object.keys(i),o,a,u,s,p;for(o=0,a=l.length;o<a;o+=1)p="",t!==""&&(p+=", "),e.condenseFlow&&(p+='"'),u=l[o],s=i[u],e.replacer&&(s=e.replacer.call(i,u,s)),N(e,n,u,!1,!1)&&(e.dump.length>1024&&(p+="? "),p+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),N(e,n,s,!1,!1)&&(p+=e.dump,t+=p));e.tag=r,e.dump="{"+t+"}"}function Mt(e,n,i,t){var r="",l=e.tag,o=Object.keys(i),a,u,s,p,c,f;if(e.sortKeys===!0)o.sort();else if(typeof e.sortKeys=="function")o.sort(e.sortKeys);else if(e.sortKeys)throw new I("sortKeys must be a boolean or a function");for(a=0,u=o.length;a<u;a+=1)f="",(!t||r!=="")&&(f+=Ce(e,n)),s=o[a],p=i[s],e.replacer&&(p=e.replacer.call(i,s,p)),N(e,n+1,s,!0,!0,!0)&&(c=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,c&&(e.dump&&V===e.dump.charCodeAt(0)?f+="?":f+="? "),f+=e.dump,c&&(f+=Ce(e,n)),N(e,n+1,p,!0,c)&&(e.dump&&V===e.dump.charCodeAt(0)?f+=":":f+=": ",f+=e.dump,r+=f));e.tag=l,e.dump=r||"{}"}function on(e,n,i){var t,r,l,o,a,u;for(r=i?e.explicitTypes:e.implicitTypes,l=0,o=r.length;l<o;l+=1)if(a=r[l],(a.instanceOf||a.predicate)&&(!a.instanceOf||typeof n=="object"&&n instanceof a.instanceOf)&&(!a.predicate||a.predicate(n))){if(i?a.multi&&a.representName?e.tag=a.representName(n):e.tag=a.tag:e.tag="?",a.represent){if(u=e.styleMap[a.tag]||a.defaultStyle,oi.call(a.represent)==="[object Function]")t=a.represent(n,u);else if(li.call(a.represent,u))t=a.represent[u](n,u);else throw new I("!<"+a.tag+'> tag resolver accepts not "'+u+'" style');e.dump=t}return!0}return!1}function N(e,n,i,t,r,l,o){e.tag=null,e.dump=i,on(e,i,!1)||on(e,i,!0);var a=oi.call(e.dump),u=t,s;t&&(t=e.flowLevel<0||e.flowLevel>n);var p=a==="[object Object]"||a==="[object Array]",c,f;if(p&&(c=e.duplicates.indexOf(i),f=c!==-1),(e.tag!==null&&e.tag!=="?"||f||e.indent!==2&&n>0)&&(r=!1),f&&e.usedDuplicates[c])e.dump="*ref_"+c;else{if(p&&f&&!e.usedDuplicates[c]&&(e.usedDuplicates[c]=!0),a==="[object Object]")t&&Object.keys(e.dump).length!==0?(Mt(e,n,e.dump,r),f&&(e.dump="&ref_"+c+e.dump)):(kt(e,n,e.dump),f&&(e.dump="&ref_"+c+" "+e.dump));else if(a==="[object Array]")t&&e.dump.length!==0?(e.noArrayIndent&&!o&&n>0?tn(e,n-1,e.dump,r):tn(e,n,e.dump,r),f&&(e.dump="&ref_"+c+e.dump)):(Ft(e,n,e.dump),f&&(e.dump="&ref_"+c+" "+e.dump));else if(a==="[object String]")e.tag!=="?"&&Nt(e,e.dump,n,l,u);else{if(a==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new I("unacceptable kind of an object to dump "+a)}e.tag!==null&&e.tag!=="?"&&(s=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?s="!"+s:s.slice(0,18)==="tag:yaml.org,2002:"?s="!!"+s.slice(18):s="!<"+s+">",e.dump=s+" "+e.dump)}return!0}function Dt(e,n){var i=[],t=[],r,l;for(_e(e,i,t),r=0,l=t.length;r<l;r+=1)n.duplicates.push(i[t[r]]);n.usedDuplicates=new Array(l)}function _e(e,n,i){var t,r,l;if(e!==null&&typeof e=="object")if(r=n.indexOf(e),r!==-1)i.indexOf(r)===-1&&i.push(r);else if(n.push(e),Array.isArray(e))for(r=0,l=e.length;r<l;r+=1)_e(e[r],n,i);else for(t=Object.keys(e),r=0,l=t.length;r<l;r+=1)_e(e[t[r]],n,i)}function Bt(e,n){n=n||{};var i=new It(n);i.noRefs||Dt(e,i);var t=e;return i.replacer&&(t=i.replacer.call({"":t},"",t)),N(i,0,t,!0,!0)?i.dump+`
`:""}var Ht=Bt,Gt={dump:Ht};function be(e,n){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+n+" instead, which is now safe by default.")}}var Yt=C,Pt=Rn,Ut=Mn,jt=Yn,Kt=Pn,qt=Ie,$t=ti.load,zt=ti.loadAll,Qt=Gt.dump,Jt=I,Vt={binary:$n,float:Gn,map:kn,null:Dn,pairs:Qn,set:Jn,timestamp:Kn,bool:Bn,int:Hn,merge:qn,omap:zn,seq:Fn,str:Ln},Wt=be("safeLoad","load"),Xt=be("safeLoadAll","loadAll"),Zt=be("safeDump","dump"),eo={Type:Yt,Schema:Pt,FAILSAFE_SCHEMA:Ut,JSON_SCHEMA:jt,CORE_SCHEMA:Kt,DEFAULT_SCHEMA:qt,load:$t,loadAll:zt,dump:Qt,YAMLException:Jt,types:Vt,safeLoad:Wt,safeLoadAll:Xt,safeDump:Zt},ln;(function(e){e.STRING="string",e.NUMBER="number",e.INTEGER="integer",e.BOOLEAN="boolean",e.ARRAY="array",e.OBJECT="object"})(ln||(ln={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var an;(function(e){e.LANGUAGE_UNSPECIFIED="language_unspecified",e.PYTHON="python"})(an||(an={}));var un;(function(e){e.OUTCOME_UNSPECIFIED="outcome_unspecified",e.OUTCOME_OK="outcome_ok",e.OUTCOME_FAILED="outcome_failed",e.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(un||(un={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sn=["user","model","function","system"];var cn;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(cn||(cn={}));var fn;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(fn||(fn={}));var dn;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(dn||(dn={}));var pn;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER"})(pn||(pn={}));var Q;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.OTHER="OTHER"})(Q||(Q={}));var hn;(function(e){e.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",e.RETRIEVAL_QUERY="RETRIEVAL_QUERY",e.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",e.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",e.CLASSIFICATION="CLASSIFICATION",e.CLUSTERING="CLUSTERING"})(hn||(hn={}));var gn;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(gn||(gn={}));var mn;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(mn||(mn={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _ extends Error{constructor(n){super(`[GoogleGenerativeAI Error]: ${n}`)}}class Y extends _{constructor(n,i){super(n),this.response=i}}class mi extends _{constructor(n,i,t,r){super(n),this.status=i,this.statusText=t,this.errorDetails=r}}class k extends _{}class vi extends _{}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const no="https://generativelanguage.googleapis.com",io="v1beta",ro="0.24.1",to="genai-js";var H;(function(e){e.GENERATE_CONTENT="generateContent",e.STREAM_GENERATE_CONTENT="streamGenerateContent",e.COUNT_TOKENS="countTokens",e.EMBED_CONTENT="embedContent",e.BATCH_EMBED_CONTENTS="batchEmbedContents"})(H||(H={}));class oo{constructor(n,i,t,r,l){this.model=n,this.task=i,this.apiKey=t,this.stream=r,this.requestOptions=l}toString(){var n,i;const t=((n=this.requestOptions)===null||n===void 0?void 0:n.apiVersion)||io;let l=`${((i=this.requestOptions)===null||i===void 0?void 0:i.baseUrl)||no}/${t}/${this.model}:${this.task}`;return this.stream&&(l+="?alt=sse"),l}}function lo(e){const n=[];return e!=null&&e.apiClient&&n.push(e.apiClient),n.push(`${to}/${ro}`),n.join(" ")}async function ao(e){var n;const i=new Headers;i.append("Content-Type","application/json"),i.append("x-goog-api-client",lo(e.requestOptions)),i.append("x-goog-api-key",e.apiKey);let t=(n=e.requestOptions)===null||n===void 0?void 0:n.customHeaders;if(t){if(!(t instanceof Headers))try{t=new Headers(t)}catch(r){throw new k(`unable to convert customHeaders value ${JSON.stringify(t)} to Headers: ${r.message}`)}for(const[r,l]of t.entries()){if(r==="x-goog-api-key")throw new k(`Cannot set reserved header name ${r}`);if(r==="x-goog-api-client")throw new k(`Header name ${r} can only be set using the apiClient field`);i.append(r,l)}}return i}async function uo(e,n,i,t,r,l){const o=new oo(e,n,i,t,l);return{url:o.toString(),fetchOptions:Object.assign(Object.assign({},po(l)),{method:"POST",headers:await ao(o),body:r})}}async function ne(e,n,i,t,r,l={},o=fetch){const{url:a,fetchOptions:u}=await uo(e,n,i,t,r,l);return so(a,u,o)}async function so(e,n,i=fetch){let t;try{t=await i(e,n)}catch(r){co(r,e)}return t.ok||await fo(t,e),t}function co(e,n){let i=e;throw i.name==="AbortError"?(i=new vi(`Request aborted when fetching ${n.toString()}: ${e.message}`),i.stack=e.stack):e instanceof mi||e instanceof k||(i=new _(`Error fetching from ${n.toString()}: ${e.message}`),i.stack=e.stack),i}async function fo(e,n){let i="",t;try{const r=await e.json();i=r.error.message,r.error.details&&(i+=` ${JSON.stringify(r.error.details)}`,t=r.error.details)}catch{}throw new mi(`Error fetching from ${n.toString()}: [${e.status} ${e.statusText}] ${i}`,e.status,e.statusText,t)}function po(e){const n={};if((e==null?void 0:e.signal)!==void 0||(e==null?void 0:e.timeout)>=0){const i=new AbortController;(e==null?void 0:e.timeout)>=0&&setTimeout(()=>i.abort(),e.timeout),e!=null&&e.signal&&e.signal.addEventListener("abort",()=>{i.abort()}),n.signal=i.signal}return n}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ne(e){return e.text=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),te(e.candidates[0]))throw new Y(`${L(e)}`,e);return ho(e)}else if(e.promptFeedback)throw new Y(`Text not available. ${L(e)}`,e);return""},e.functionCall=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),te(e.candidates[0]))throw new Y(`${L(e)}`,e);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),vn(e)[0]}else if(e.promptFeedback)throw new Y(`Function call not available. ${L(e)}`,e)},e.functionCalls=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),te(e.candidates[0]))throw new Y(`${L(e)}`,e);return vn(e)}else if(e.promptFeedback)throw new Y(`Function call not available. ${L(e)}`,e)},e}function ho(e){var n,i,t,r;const l=[];if(!((i=(n=e.candidates)===null||n===void 0?void 0:n[0].content)===null||i===void 0)&&i.parts)for(const o of(r=(t=e.candidates)===null||t===void 0?void 0:t[0].content)===null||r===void 0?void 0:r.parts)o.text&&l.push(o.text),o.executableCode&&l.push("\n```"+o.executableCode.language+`
`+o.executableCode.code+"\n```\n"),o.codeExecutionResult&&l.push("\n```\n"+o.codeExecutionResult.output+"\n```\n");return l.length>0?l.join(""):""}function vn(e){var n,i,t,r;const l=[];if(!((i=(n=e.candidates)===null||n===void 0?void 0:n[0].content)===null||i===void 0)&&i.parts)for(const o of(r=(t=e.candidates)===null||t===void 0?void 0:t[0].content)===null||r===void 0?void 0:r.parts)o.functionCall&&l.push(o.functionCall);if(l.length>0)return l}const go=[Q.RECITATION,Q.SAFETY,Q.LANGUAGE];function te(e){return!!e.finishReason&&go.includes(e.finishReason)}function L(e){var n,i,t;let r="";if((!e.candidates||e.candidates.length===0)&&e.promptFeedback)r+="Response was blocked",!((n=e.promptFeedback)===null||n===void 0)&&n.blockReason&&(r+=` due to ${e.promptFeedback.blockReason}`),!((i=e.promptFeedback)===null||i===void 0)&&i.blockReasonMessage&&(r+=`: ${e.promptFeedback.blockReasonMessage}`);else if(!((t=e.candidates)===null||t===void 0)&&t[0]){const l=e.candidates[0];te(l)&&(r+=`Candidate was blocked due to ${l.finishReason}`,l.finishMessage&&(r+=`: ${l.finishMessage}`))}return r}function Z(e){return this instanceof Z?(this.v=e,this):new Z(e)}function mo(e,n,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=i.apply(e,n||[]),r,l=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(f){t[f]&&(r[f]=function(d){return new Promise(function(g,m){l.push([f,d,g,m])>1||a(f,d)})})}function a(f,d){try{u(t[f](d))}catch(g){c(l[0][3],g)}}function u(f){f.value instanceof Z?Promise.resolve(f.value.v).then(s,p):c(l[0][2],f)}function s(f){a("next",f)}function p(f){a("throw",f)}function c(f,d){f(d),l.shift(),l.length&&a(l[0][0],l[0][1])}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const An=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function vo(e){const n=e.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),i=Eo(n),[t,r]=i.tee();return{stream:xo(t),response:Ao(r)}}async function Ao(e){const n=[],i=e.getReader();for(;;){const{done:t,value:r}=await i.read();if(t)return Ne(Co(n));n.push(r)}}function xo(e){return mo(this,arguments,function*(){const i=e.getReader();for(;;){const{value:t,done:r}=yield Z(i.read());if(r)break;yield yield Z(Ne(t))}})}function Eo(e){const n=e.getReader();return new ReadableStream({start(t){let r="";return l();function l(){return n.read().then(({value:o,done:a})=>{if(a){if(r.trim()){t.error(new _("Failed to parse stream"));return}t.close();return}r+=o;let u=r.match(An),s;for(;u;){try{s=JSON.parse(u[1])}catch{t.error(new _(`Error parsing JSON response: "${u[1]}"`));return}t.enqueue(s),r=r.substring(u[0].length),u=r.match(An)}return l()}).catch(o=>{let a=o;throw a.stack=o.stack,a.name==="AbortError"?a=new vi("Request aborted when reading from the stream"):a=new _("Error reading from the stream"),a})}}})}function Co(e){const n=e[e.length-1],i={promptFeedback:n==null?void 0:n.promptFeedback};for(const t of e){if(t.candidates){let r=0;for(const l of t.candidates)if(i.candidates||(i.candidates=[]),i.candidates[r]||(i.candidates[r]={index:r}),i.candidates[r].citationMetadata=l.citationMetadata,i.candidates[r].groundingMetadata=l.groundingMetadata,i.candidates[r].finishReason=l.finishReason,i.candidates[r].finishMessage=l.finishMessage,i.candidates[r].safetyRatings=l.safetyRatings,l.content&&l.content.parts){i.candidates[r].content||(i.candidates[r].content={role:l.content.role||"user",parts:[]});const o={};for(const a of l.content.parts)a.text&&(o.text=a.text),a.functionCall&&(o.functionCall=a.functionCall),a.executableCode&&(o.executableCode=a.executableCode),a.codeExecutionResult&&(o.codeExecutionResult=a.codeExecutionResult),Object.keys(o).length===0&&(o.text=""),i.candidates[r].content.parts.push(o)}r++}t.usageMetadata&&(i.usageMetadata=t.usageMetadata)}return i}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ai(e,n,i,t){const r=await ne(n,H.STREAM_GENERATE_CONTENT,e,!0,JSON.stringify(i),t);return vo(r)}async function xi(e,n,i,t){const l=await(await ne(n,H.GENERATE_CONTENT,e,!1,JSON.stringify(i),t)).json();return{response:Ne(l)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ei(e){if(e!=null){if(typeof e=="string")return{role:"system",parts:[{text:e}]};if(e.text)return{role:"system",parts:[e]};if(e.parts)return e.role?e:{role:"system",parts:e.parts}}}function ee(e){let n=[];if(typeof e=="string")n=[{text:e}];else for(const i of e)typeof i=="string"?n.push({text:i}):n.push(i);return yo(n)}function yo(e){const n={role:"user",parts:[]},i={role:"function",parts:[]};let t=!1,r=!1;for(const l of e)"functionResponse"in l?(i.parts.push(l),r=!0):(n.parts.push(l),t=!0);if(t&&r)throw new _("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!t&&!r)throw new _("No content is provided for sending chat message.");return t?n:i}function _o(e,n){var i;let t={model:n==null?void 0:n.model,generationConfig:n==null?void 0:n.generationConfig,safetySettings:n==null?void 0:n.safetySettings,tools:n==null?void 0:n.tools,toolConfig:n==null?void 0:n.toolConfig,systemInstruction:n==null?void 0:n.systemInstruction,cachedContent:(i=n==null?void 0:n.cachedContent)===null||i===void 0?void 0:i.name,contents:[]};const r=e.generateContentRequest!=null;if(e.contents){if(r)throw new k("CountTokensRequest must have one of contents or generateContentRequest, not both.");t.contents=e.contents}else if(r)t=Object.assign(Object.assign({},t),e.generateContentRequest);else{const l=ee(e);t.contents=[l]}return{generateContentRequest:t}}function xn(e){let n;return e.contents?n=e:n={contents:[ee(e)]},e.systemInstruction&&(n.systemInstruction=Ei(e.systemInstruction)),n}function So(e){return typeof e=="string"||Array.isArray(e)?{content:ee(e)}:e}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const En=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],Io={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function Oo(e){let n=!1;for(const i of e){const{role:t,parts:r}=i;if(!n&&t!=="user")throw new _(`First content should be with role 'user', got ${t}`);if(!sn.includes(t))throw new _(`Each item should include role field. Got ${t} but valid roles are: ${JSON.stringify(sn)}`);if(!Array.isArray(r))throw new _("Content should have 'parts' property with an array of Parts");if(r.length===0)throw new _("Each Content should have at least one part");const l={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const a of r)for(const u of En)u in a&&(l[u]+=1);const o=Io[t];for(const a of En)if(!o.includes(a)&&l[a]>0)throw new _(`Content with role '${t}' can't contain '${a}' part`);n=!0}}function Cn(e){var n;if(e.candidates===void 0||e.candidates.length===0)return!1;const i=(n=e.candidates[0])===null||n===void 0?void 0:n.content;if(i===void 0||i.parts===void 0||i.parts.length===0)return!1;for(const t of i.parts)if(t===void 0||Object.keys(t).length===0||t.text!==void 0&&t.text==="")return!1;return!0}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yn="SILENT_ERROR";class wo{constructor(n,i,t,r={}){this.model=i,this.params=t,this._requestOptions=r,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=n,t!=null&&t.history&&(Oo(t.history),this._history=t.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(n,i={}){var t,r,l,o,a,u;await this._sendPromise;const s=ee(n),p={safetySettings:(t=this.params)===null||t===void 0?void 0:t.safetySettings,generationConfig:(r=this.params)===null||r===void 0?void 0:r.generationConfig,tools:(l=this.params)===null||l===void 0?void 0:l.tools,toolConfig:(o=this.params)===null||o===void 0?void 0:o.toolConfig,systemInstruction:(a=this.params)===null||a===void 0?void 0:a.systemInstruction,cachedContent:(u=this.params)===null||u===void 0?void 0:u.cachedContent,contents:[...this._history,s]},c=Object.assign(Object.assign({},this._requestOptions),i);let f;return this._sendPromise=this._sendPromise.then(()=>xi(this._apiKey,this.model,p,c)).then(d=>{var g;if(Cn(d.response)){this._history.push(s);const m=Object.assign({parts:[],role:"model"},(g=d.response.candidates)===null||g===void 0?void 0:g[0].content);this._history.push(m)}else{const m=L(d.response);m&&console.warn(`sendMessage() was unsuccessful. ${m}. Inspect response object for details.`)}f=d}).catch(d=>{throw this._sendPromise=Promise.resolve(),d}),await this._sendPromise,f}async sendMessageStream(n,i={}){var t,r,l,o,a,u;await this._sendPromise;const s=ee(n),p={safetySettings:(t=this.params)===null||t===void 0?void 0:t.safetySettings,generationConfig:(r=this.params)===null||r===void 0?void 0:r.generationConfig,tools:(l=this.params)===null||l===void 0?void 0:l.tools,toolConfig:(o=this.params)===null||o===void 0?void 0:o.toolConfig,systemInstruction:(a=this.params)===null||a===void 0?void 0:a.systemInstruction,cachedContent:(u=this.params)===null||u===void 0?void 0:u.cachedContent,contents:[...this._history,s]},c=Object.assign(Object.assign({},this._requestOptions),i),f=Ai(this._apiKey,this.model,p,c);return this._sendPromise=this._sendPromise.then(()=>f).catch(d=>{throw new Error(yn)}).then(d=>d.response).then(d=>{if(Cn(d)){this._history.push(s);const g=Object.assign({},d.candidates[0].content);g.role||(g.role="model"),this._history.push(g)}else{const g=L(d);g&&console.warn(`sendMessageStream() was unsuccessful. ${g}. Inspect response object for details.`)}}).catch(d=>{d.message!==yn&&console.error(d)}),f}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function To(e,n,i,t){return(await ne(n,H.COUNT_TOKENS,e,!1,JSON.stringify(i),t)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bo(e,n,i,t){return(await ne(n,H.EMBED_CONTENT,e,!1,JSON.stringify(i),t)).json()}async function No(e,n,i,t){const r=i.requests.map(o=>Object.assign(Object.assign({},o),{model:n}));return(await ne(n,H.BATCH_EMBED_CONTENTS,e,!1,JSON.stringify({requests:r}),t)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(n,i,t={}){this.apiKey=n,this._requestOptions=t,i.model.includes("/")?this.model=i.model:this.model=`models/${i.model}`,this.generationConfig=i.generationConfig||{},this.safetySettings=i.safetySettings||[],this.tools=i.tools,this.toolConfig=i.toolConfig,this.systemInstruction=Ei(i.systemInstruction),this.cachedContent=i.cachedContent}async generateContent(n,i={}){var t;const r=xn(n),l=Object.assign(Object.assign({},this._requestOptions),i);return xi(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(t=this.cachedContent)===null||t===void 0?void 0:t.name},r),l)}async generateContentStream(n,i={}){var t;const r=xn(n),l=Object.assign(Object.assign({},this._requestOptions),i);return Ai(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(t=this.cachedContent)===null||t===void 0?void 0:t.name},r),l)}startChat(n){var i;return new wo(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(i=this.cachedContent)===null||i===void 0?void 0:i.name},n),this._requestOptions)}async countTokens(n,i={}){const t=_o(n,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),r=Object.assign(Object.assign({},this._requestOptions),i);return To(this.apiKey,this.model,t,r)}async embedContent(n,i={}){const t=So(n),r=Object.assign(Object.assign({},this._requestOptions),i);return bo(this.apiKey,this.model,t,r)}async batchEmbedContents(n,i={}){const t=Object.assign(Object.assign({},this._requestOptions),i);return No(this.apiKey,this.model,n,t)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(n){this.apiKey=n}getGenerativeModel(n,i){if(!n.model)throw new _("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new _n(this.apiKey,n,i)}getGenerativeModelFromCachedContent(n,i,t){if(!n.name)throw new k("Cached content must contain a `name` field.");if(!n.model)throw new k("Cached content must contain a `model` field.");const r=["model","systemInstruction"];for(const o of r)if(i!=null&&i[o]&&n[o]&&(i==null?void 0:i[o])!==n[o]){if(o==="model"){const a=i.model.startsWith("models/")?i.model.replace("models/",""):i.model,u=n.model.startsWith("models/")?n.model.replace("models/",""):n.model;if(a===u)continue}throw new k(`Different value for "${o}" specified in modelParams (${i[o]}) and cachedContent (${n[o]})`)}const l=Object.assign(Object.assign({},i),{model:n.model,tools:n.tools,toolConfig:n.toolConfig,systemInstruction:n.systemInstruction,cachedContent:n});return new _n(this.apiKey,l,t)}}let ie=null,Ae=null;const Ro="gemini-1.5-flash-latest";let re="";async function Lo(){if(re)return re;try{const e=await fetch("/KwekKwekQuiz/data/promptEngineeringText.txt");if(!e.ok)throw new Error(`File not found or network error: ${e.statusText}`);return re=await e.text(),re}catch(e){return console.error("Error loading promptEngineeringText.txt:",e),T("Failed to load internal prompt configuration. AI generation might be affected."),"Generate a quiz in JSON format based on the following topic: "}}function Fo(){if(!K||!In)return console.error("API Key input (settings) or errorDiv not found in DOM for Gemini client."),null;const e=K.value.trim();if(!e)return T("API Key is required for AI generation. Please set it in Settings."),null;if(!ie||Ae!==e)try{if(typeof Sn!="function")throw new Error("GoogleGenerativeAI is not available. Check import.");ie=new Sn(e),Ae=e,q(),console.log("Gemini client initialized/re-initialized.")}catch(n){return T("Failed to initialize Gemini client: "+n.message),console.error("Initialization error in getGenAIClient:",n),ie=null,Ae=null,null}return ie}async function ko(){if(!K||!y||!In||!R)return;const e=y.value.trim();if(!K.value.trim()){T("A Gemini API Key is required. Please set it in the Settings page. Get one from https://aistudio.google.com/");return}if(!e){T("Please enter a topic or prompt in the textarea to generate a quiz.");return}const i=Fo();if(!i){y.value="Failed to initialize AI client. Check API Key and errors.";return}const t=await Lo(),r=R.innerHTML;R.disabled=!0,R.innerHTML='<span class="loading-dots"><span>.</span><span>.</span><span>.</span></span> Generating',y.value,y.value="Generating quiz content...",q();try{const l=i.getGenerativeModel({model:Ro}),o=t+e,s=(await(await l.generateContent(o)).response).text(),p=s.replace(/```json\s*/gi,"").replace(/```/g,"").trim();let c;try{c=JSON.parse(p),y.value=JSON.stringify(c,null,2),q()}catch(f){console.error("JSON Parse Error from AI:",f.message,`
Raw AI output:`,s),y.value=`Invalid JSON generated. Check console for raw output.

Original prompt was:
`+e+`

Raw AI output:
`+s,T("AI generated invalid JSON: "+f.message)}}catch(l){console.error("Error generating text with AI:",l);let o="Error generating text: "+(l.message||"Unknown AI error");l.toString().includes("API key not valid")?o+=" Your API Key might be invalid or not enabled for the Gemini API.":l.toString().includes("Quota exceeded")&&(o+=" You may have exceeded your API quota."),y.value=`Error during AI generation. Original prompt: "${e}"`,T(o)}finally{R.disabled=!1,R.innerHTML=r}}function Mo(){if(q(),!y)return;let e;try{e=JSON.parse(y.value)}catch{T("Invalid JSON format. Please correct and try again.");return}Fi(e)&&ae("Quiz loaded successfully!")}function Do(){if(q(),!y)return;const e=y.value.trim();if(e===""){T("Textarea is empty. Nothing to format.");return}try{const n=JSON.parse(e);y.value=JSON.stringify(n,null,2),ae("JSON formatted successfully!")}catch(n){try{const i=eo.load(e);y.value=JSON.stringify(i,null,2),ae("YAML converted to JSON successfully!")}catch(i){T(`Invalid JSON or YAML.
JSON Error: ${n.message}
YAML Error: ${i.message}`)}}}function Bo(){q(),y&&(y.value=Ci),he&&(he.value="Sample Quiz",delete he.dataset.editingExisting),ae("Sample quiz loaded!")}function Ho(){const e=K,n=On;e.type==="password"?(e.type="text",n.textContent="visibility"):(e.type="password",n.textContent="visibility_off")}function Go(e){const n=document.activeElement;if(!n)return;const i=n.tagName;if(!((i==="INPUT"||i==="TEXTAREA")&&!(D&&!D.classList.contains("hidden")&&n===D.querySelector("input[type='text']")&&e.key==="Enter"))&&D&&!D.classList.contains("hidden"))if(e.key==="ArrowLeft")oe&&!oe.disabled&&(e.preventDefault(),wn());else if(e.key==="ArrowRight")le&&!le.disabled&&(e.preventDefault(),Tn());else{const t=yi();if(!t||_i(Si()))return;if(t.type==="multiple-choice"){const r=parseInt(e.key,10)-1;if(r>=0&&t.options&&r<t.options.length){const l=D.querySelectorAll("ul li button");l[r]&&!l[r].disabled&&(e.preventDefault(),l[r].click())}}else if(t.type==="true-false"&&(e.key==="1"||e.key==="0")){const r=D.querySelectorAll("ul li button"),l=Array.from(r).find(o=>{const a=o.querySelector("span.font-semibold");return a&&a.textContent===e.key});l&&!l.disabled&&(e.preventDefault(),l.click())}}}function $o(){Re&&Re.addEventListener("click",Mo),Le&&Le.addEventListener("click",Do),Fe&&Fe.addEventListener("click",Bo),ke&&ke.addEventListener("click",Ii),Me&&Me.addEventListener("click",Oi),De&&De.addEventListener("change",wi),R&&R.addEventListener("click",ko),oe&&oe.addEventListener("click",wn),le&&le.addEventListener("click",Tn),Be&&Be.addEventListener("click",Ri),He&&He.addEventListener("click",Li),Ge&&Ge.addEventListener("click",ki),Ye&&Ye.addEventListener("click",Ti),Pe&&Pe.addEventListener("change",bi),Ue&&Ue.addEventListener("click",Ni),je&&K&&On&&je.addEventListener("click",Ho),document.addEventListener("keydown",Go),console.log("All event listeners dynamically attached/verified.")}export{$o as attachAllEventHandlers};
